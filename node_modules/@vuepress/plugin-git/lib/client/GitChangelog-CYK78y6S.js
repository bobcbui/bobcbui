import{useToggle as S}from"@vueuse/core";import{computed as m,toValue as p,defineComponent as I,h as e}from"vue";import{u,V as T}from"./VPHeader-rHRE0sTK.js";import"./styles/vars.css";import"./styles/changelog.css";import{usePageFrontmatter as w,usePageLang as h,usePageData as v}from"vuepress/client";import{isLinkHttp as C}from"@vuepress/helper/client";const d=typeof __GIT_OPTIONS__>"u"?{}:__GIT_OPTIONS__,L=(a,o)=>!a||C(a)?a:o==="github"?`https://github.com/${a}`:o==="gitee"?`https://gitee.com/${a}`:a,y=/#(\d+)/g,_=typeof __GIT_CHANGELOG__=="boolean"&&__GIT_CHANGELOG__?(a=!0)=>{const o=w(),n=h(),r=v(),{pattern:l={},provider:i}=d,s=L(d.repo,i);return m(()=>{if(o.value.changelog===!1||!p(a))return[];const c=new Intl.DateTimeFormat(n.value,{dateStyle:"short"});return(r.value.git?.changelog??[]).map(g=>{const t={date:c.format(g.time),...g};return l.issue&&s&&(t.message=t.message.replace(y,(G,O)=>`<a href="${l.issue.replace(":issue",O).replace(":repo",s)}" target="_blank" rel="noopener noreferrer">${G}</a>`)),l.commit&&s&&(t.commitUrl=l.commit.replace(":hash",t.hash).replace(":repo",s)),l.tag&&s&&t.tag&&(t.tagUrl=l.tag.replace(":tag",t.tag).replace(":repo",s)),t})})}:()=>m(()=>[]),f=(a=!0)=>{const o=h(),n=u(),r=v();return m(()=>{if(!p(a))return null;const l=r.value.git?.updatedTime??r.value.git?.changelog?.[0].time;if(!l)return null;const i=new Date(l),s=new Intl.DateTimeFormat(o.value,{dateStyle:"short",timeStyle:"short"}).format(l);return{date:i,text:s,iso:i.toISOString(),locale:n.value.latestUpdateAt}})},k=I({name:"GitChangelog",props:{title:String,headerLevel:{type:Number,default:2}},setup(a){const o=_(),n=u(),r=f(),[l,i]=S(),s=()=>e("div",{class:"vp-changelog-header",onClick:()=>i()},[e("div",{class:"vp-latest-updated"},[e("span",{class:"vp-changelog-icon"}),e("span",{"data-allow-mismatch":""},r.value.text)]),e("div",[e("span",{class:"vp-changelog-menu-icon"}),e("span",n.value.viewChangelog)])]),c=({item:t})=>e("li",{class:"vp-changelog-item-tag"},e("div",[e("a",{class:"vp-changelog-tag"},e("code",t.tag)),e("span",{class:"vp-changelog-date","data-allow-mismatch":""},[n.value.timeOn," ",e("time",{datetime:new Date(t.time).toISOString()},t.date)])])),g=({item:t})=>e("li",{class:"vp-changelog-item-commit"},[e(t.commitUrl?"a":"span",{class:"vp-changelog-hash",href:t.commitUrl,target:"_blank",rel:"noreferrer"},[e("code",t.hash.slice(0,5))]),e("span",{class:"vp-changelog-divider"},"-"),e("span",{class:"vp-changelog-message",innerHTML:t.message}),e("span",{class:"vp-changelog-date","data-allow-mismatch":""},[n.value.timeOn||"on"," ",e("time",{datetime:new Date(t.time).toISOString()},t.date)])]);return()=>o.value.length?[e(T,{level:a.headerLevel,anchor:"doc-changelog",text:a.title||n.value.changelog}),e("div",{class:["vp-changelog-wrapper",{active:l.value}]},[e(s),e("ul",{class:"vp-changelog-list"},[o.value.map(t=>t.tag?e(c,{item:t,key:t.tag}):e(g,{item:t,key:t.hash}))])])]:null}});export{k as G,f as a,_ as u};
//# sourceMappingURL=GitChangelog-CYK78y6S.js.map
